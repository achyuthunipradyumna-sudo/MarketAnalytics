<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Trend Dashboard</title>
  <script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>
</head>
<body>

<h3>Trend â€” Market Structure</h3>
<div id="chart"></div>

<script>
fetch("breadth_full_history.csv")
.then(r=>r.text())
.then(t=>{
  const rows=t.trim().split("\n");
  const h=rows[0].split(",");
  const d=rows.slice(1).map(r=>{
    let o={}; r.split(",").forEach((v,i)=>o[h[i]]=v); return o;
  });

  const x=d.map(r=>r.Date);

  Plotly.newPlot("chart",[
    {x,y:d.map(r=>+r.nifty50_dist_200_z),name:"Nifty Dist 200DMA Z"},
    {x,y:d.map(r=>+r.nifty50_mom_126),name:"6M Momentum"},
    {x,y:d.map(r=>+r.nifty50_persistence_200),name:"200DMA Persistence",yaxis:"y2"}
  ],{
    height:600,
    hovermode:"x unified",
    yaxis:{title:"Z / Momentum"},
    yaxis2:{title:"% Time Above 200DMA",overlaying:"y",side:"right"},
    shapes:[{type:"line",x0:0,x1:1,y0:0,y1:0,xref:"paper"}]
  },{
    scrollZoom:false,
    doubleClick:false
  });
});
</script>

</body>
</html>
